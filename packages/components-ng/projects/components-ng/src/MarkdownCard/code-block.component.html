<div
  class="mc-code-block"
  [ngClass]="theme === 'dark' ? 'mc-code-block-dark' : 'mc-code-block-light'"
  #rootRef
>
  <div class="mc-code-block-header" *ngIf="!headerTemplate">
    <span class="mc-code-lang">{{ language }}</span>
    <ng-container *ngIf="!actionsTemplate">
      <div class="mc-code-block-actions">
        <div *ngIf="isMermaid" style="margin-right: 8px">
          <ul
            class="mc-diagram-switch"
            [ngClass]="{ 'mc-show-code': !showMermaidDiagram }"
          >
            <li
              (click)="showMermaidDiagram = true"
              [ngClass]="{ 'mc-diagram-switch-active': showMermaidDiagram }"
            >
              图表
            </li>
            <li
              (click)="showMermaidDiagram = false"
              [ngClass]="{ 'mc-diagram-switch-active': !showMermaidDiagram }"
            >
              代码
            </li>
          </ul>
        </div>
        <div
          *ngIf="isMermaid && showMermaidDiagram"
          class="mc-action-btn mc-toggle-btn"
          title="放大"
          (click)="zoomIn()"
        >
          <img src="assets/MarkdownCard/asset/enlarge.svg" />
        </div>
        <div
          *ngIf="isMermaid && showMermaidDiagram"
          class="mc-action-btn mc-toggle-btn"
          title="缩小"
          (click)="zoomOut()"
        >
          <img src="assets/MarkdownCard/asset/zoom-out-2.svg" />
        </div>
        <div
          *ngIf="isMermaid && showMermaidDiagram"
          class="mc-action-btn mc-toggle-btn"
          title="下载"
          (click)="download()"
        >
          <img src="assets/MarkdownCard/asset/download-2.svg" />
        </div>
        <div
          class="mc-action-btn mc-toggle-btn"
          title="展开/折叠"
          (click)="toggleExpand()"
        >
          <svg
            width="16px"
            height="16px"
            viewBox="0 0 16 16"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
          >
            <title>全部收起</title>
            <g
              id="全部收起"
              stroke="none"
              stroke-width="1"
              fill="none"
              fill-rule="evenodd"
            >
              <path
                d="M4.715694,14.4114091 C4.910563,14.5464051 5.179987,14.5271201 5.353553,14.3535531 L5.353553,14.3535531 L7.99999988,11.7070001 L10.646447,14.3535531 L10.715694,14.4114091 C10.910563,14.5464051 11.179987,14.5271201 11.353553,14.3535531 C11.548816,14.1582911 11.548816,13.8417091 11.353553,13.6464471 L11.353553,13.6464471 L8.353553,10.6464471 L8.284306,10.5885911 C8.089437,10.4535951 7.820013,10.4728801 7.646447,10.6464471 L7.646447,10.6464471 L4.646447,13.6464471 L4.588591,13.7156941 C4.453595,13.9105631 4.47288,14.1799871 4.646447,14.3535531 L4.646447,14.3535531 L4.715694,14.4114091 Z M14.5,7.50000012 C14.776142,7.50000012 15,7.72385812 15,8.00000012 C15,8.27614212 14.776142,8.50000012 14.5,8.50000012 L1.5,8.50000012 C1.223858,8.50000012 1,8.27614212 1,8.00000012 C1,7.72385812 1.223858,7.50000012 1.5,7.50000012 L14.5,7.50000012 Z M8.284306,5.41140912 L8.353553,5.35355312 L11.353553,2.35355312 C11.548816,2.15829112 11.548816,1.84170912 11.353553,1.64644712 C11.179987,1.47288012 10.910563,1.45359512 10.715694,1.58859112 L10.646447,1.64644712 L7.99999988,4.29300012 L5.353553,1.64644712 C5.179987,1.47288012 4.910563,1.45359512 4.715694,1.58859112 L4.646447,1.64644712 C4.47288,1.82001312 4.453595,2.08943712 4.588591,2.28430612 L4.646447,2.35355312 L7.646447,5.35355312 C7.820013,5.52712012 8.089437,5.54640512 8.284306,5.41140912 Z"
                id="形状结合"
                fill="#71757F"
                fill-rule="nonzero"
              ></path>
            </g>
          </svg>
        </div>
        <div
          class="mc-action-btn mc-copy-btn"
          title="复制"
          (click)="copyCode()"
        >
          <svg
            *ngIf="!copied"
            width="16px"
            height="16px"
            viewBox="0 0 16 16"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
          >
            <title>function icon/copy</title>
            <g
              id="页面-1"
              stroke="none"
              stroke-width="1"
              fill="none"
              fill-rule="evenodd"
            >
              <g
                id="API-starter-图标入库"
                transform="translate(-592.000000, -204.000000)"
              >
                <g
                  id="方格备份-16"
                  transform="translate(560.000000, 180.000000)"
                >
                  <text
                    id="图标"
                    font-family="PingFangSC-Regular, PingFang SC"
                    font-size="12"
                    font-weight="normal"
                    line-spacing="16"
                    fill="#71757F"
                  >
                    <tspan x="27.136" y="61">复制</tspan>
                  </text>
                </g>
                <path
                  d="M604.5,206 C605.279696,206 605.920449,206.594888 605.993133,207.35554 L606,207.5 L606,214.5 C606,215.279696 605.405112,215.920449 604.64446,215.993133 L604.5,216 L604,216 L604,216.5 C604,217.279696 603.405112,217.920449 602.64446,217.993133 L602.5,218 L595.5,218 C594.671573,218 594,217.328427 594,216.5 L594,216.5 L594,209.5 C594,208.671573 594.671573,208 595.5,208 L595.5,208 L596,208 L596,207.5 C596,206.720304 596.594888,206.079551 597.35554,206.006867 L597.5,206 L604.5,206 Z M602.5,209 L595.5,209 C595.223858,209 595,209.223858 595,209.5 L595,209.5 L595,216.5 C595,216.776142 595.223858,217 595.5,217 L595.5,217 L602.5,217 C602.776142,217 603,216.776142 603,216.5 L603,216.5 L603,209.5 C603,209.223858 602.776142,209 602.5,209 L602.5,209 Z M604.5,207 L597.5,207 C597.25454,207 597.050392,207.176875 597.008056,207.410124 L597,207.5 L597,208 L602.5,208 C603.279696,208 603.920449,208.594888 603.993133,209.35554 L604,209.5 L604,215 L604.5,215 C604.74546,215 604.949608,214.823125 604.991944,214.589876 L605,214.5 L605,207.5 C605,207.25454 604.823125,207.050392 604.589876,207.008056 L604.5,207 Z"
                  id="形状结合"
                  fill="#71757F"
                  fill-rule="nonzero"
                ></path>
              </g>
            </g>
          </svg>
          <svg *ngIf="copied" 
            width="16px"
            height="16px"
            viewBox="0 0 16 16"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
          >
            <title>status/whiteBG/correct</title>
            <desc>Created with Sketch.</desc>
            <defs>
              <polygon
                id="path-1"
                points="6.53553391 9.77817459 12.1923882 4.12132034 13.6066017 5.53553391 6.53553391 12.6066017 3 9.07106781 4.41421356 7.65685425 6.53553391 9.77817459"
              ></polygon>
            </defs>
            <g
              id="status/whiteBG/correct"
              stroke="none"
              stroke-width="1"
              fill="none"
              fill-rule="evenodd"
            >
              <mask id="mask-2" fill="white">
                <use xlink:href="#path-1"></use>
              </mask>
              <use id="Mask" fill="#3DCCA6" xlink:href="#path-1"></use>
            </g>
          </svg>
        </div>
      </div>
    </ng-container>
    <ng-container *ngIf="actionsTemplate">
      <ng-template [ngTemplateOutlet]="actionsTemplate"></ng-template>
    </ng-container>
  </div>
  <ng-container *ngIf="headerTemplate">
    <ng-template [ngTemplateOutlet]="headerTemplate"></ng-template>
  </ng-container>

  <div [@collapse]="expanded ? 'expanded' : 'collapsed'">
    <div
      *ngIf="isMermaid && showMermaidDiagram && !contentTemplate"
      class="mc-mermaid-content"
      #mermaidContent
    ></div>
    <pre
      *ngIf="!contentTemplate"
    ><code [ngClass]="'hljs language-' + language" [innerHTML]="highlightedCode"></code></pre>
    <ng-container *ngIf="contentTemplate">
      <ng-template [ngTemplateOutlet]="contentTemplate"></ng-template>
    </ng-container>
  </div>
</div>
